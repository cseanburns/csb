<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Regular Expressions - Linux Systems Administration</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Book on entry level Linux systems administration work.">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch store.js from local - TODO add CDN when 2.x.x is available on cdnjs -->
        <script src="store.js"></script>

    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = store.get('mdbook-theme');
            if (theme === null || theme === undefined) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = store.get('mdbook-sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="./linux-sysadmin.html"><strong>1.</strong> Linux Systems Administration</a></li><li><a href="./p1-system-basics.html"><strong>2.</strong> System Basics</a></li><li><ul class="section"><li><a href="./01-history-linux-unix.html"><strong>2.1.</strong> History of Unix and Linux</a></li><li><a href="./02-quick-ssh-connect.html"><strong>2.2.</strong> Connect to a Remote Server</a></li><li><a href="./03-filesystem-file-management.html"><strong>2.3.</strong> Linux Filesystems and File Management</a></li><li><a href="./04-file-attributes.html"><strong>2.4.</strong> File Attributes</a></li><li><a href="./05-text-processing-part-1.html"><strong>2.5.</strong> Text Processing, Part 1</a></li><li><a href="./06-text-processing-part-2.html"><strong>2.6.</strong> Text Processing, Part 2</a></li><li><a href="./07-text-editors.html"><strong>2.7.</strong> Text Editors</a></li><li><a href="./08-revisiting-paths.html"><strong>2.8.</strong> Revisiting Paths</a></li><li><a href="./09-bash-scripting.html"><strong>2.9.</strong> Bash Scripting</a></li><li><a href="./10-regular-expressions.html" class="active"><strong>2.10.</strong> Regular Expressions</a></li></ul></li><li><a href="./p2-managing-services-software.html"><strong>3.</strong> Managing Services and Software</a></li><li><ul class="section"><li><a href="./11-using-gcloud.html"><strong>3.1.</strong> Using gcloud for Virtual Machines</a></li><li><a href="./12-logical-volumes.html"><strong>3.2.</strong> Logical Volume Management</a></li><li><a href="./13-virtualbox-nat.html"><strong>3.3.</strong> Using NAT in VirtualBox</a></li><li><a href="./14-webconsole-nat.html"><strong>3.4.</strong> NAT Table in VirtualBox</a></li><li><a href="./15-managing-users-groups.html"><strong>3.5.</strong> Managing Users and Groups</a></li><li><a href="./16-systemd.html"><strong>3.6.</strong> systemd</a></li><li><a href="./17-backup-and-using-dnf.html"><strong>3.7.</strong> Backups and DNF</a></li></ul></li><li><a href="./p3-networking-security.html"><strong>4.</strong> Networking and Security</a></li><li><ul class="section"><li><a href="./18-tcip-networking.html"><strong>4.1.</strong> TCIP Networking</a></li><li><a href="./19-networking-dns-domains.html"><strong>4.2.</strong> DNS and Domain Names</a></li><li><a href="./20-security-chroot.html"><strong>4.3.</strong> Security and chroot</a></li><li><a href="./21-security-firewall.html"><strong>4.4.</strong> Security and Firewalls</a></li></ul></li><li><a href="./p4-lamp.html"><strong>5.</strong> Creating a LAMP Server</a></li><li><ul class="section"><li><a href="./22-httpd-apache.html"><strong>5.1.</strong> Apache2 Web Server</a></li><li><a href="./23-httpd-php.html"><strong>5.2.</strong> Apache2 and PHP</a></li><li><a href="./24-httpd-virtualhosts.html"><strong>5.3.</strong> Apache2 and Virtual Hosts</a></li><li><a href="./25-httpd-mysql.html"><strong>5.4.</strong> Apache2 and MySQL</a></li></ul></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page" tabindex="-1">
                
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars" title="Toggle sidebar"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush" title="Change theme"></i>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html">
                            <i id="print-button" class="fa fa-print" title="Print this book"></i>
                        </a>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="./10-regular-expressions.html#grep-and-regular-expressions" id="grep-and-regular-expressions"><h1>Grep and Regular Expressions</h1></a>
<p>Oftentimes, as systems administrators,
we will need to search the contents of a file, like a log file.
One of the commands that we use to do that is the <code>grep</code> command.
We have already discussed using the <code>grep</code> command,
which is not unlike doing any kind of search,
such as in Google.
The command simply involves running <code>grep</code>
along with the search string and against a file.</p>
<a class="header" href="./10-regular-expressions.html#multiword-strings" id="multiword-strings"><h2>Multiword strings</h2></a>
<p>It's good habit to include search strings within quotes,
but this is especially important if
we would search for multiword strings.
In these cases, we must enclose them in quotes.</p>
<pre><code>cat cities.csv
City | 2020 Census | Founded
New York City, NY | 8804190 | 1624
Los Angeles, CA | 3898747 | 1781
Chicago, IL | 2746388 | 1780
Houston, TX | 2304580 | 1837
Phoenix, AZ | 1624569 | 1881
Philadelphia, PA | 1576251 | 1701
San Antonio, TX | 1451853 | 1718
San Diego, CA | 1381611 | 1769
Dallas, TX | 1288457 | 1856
San Jose, CA | 983489 | 1777

grep &quot;San Antonio&quot; cities.csv
San Antonio, TX | 1451853 | 1718
</code></pre>
<a class="header" href="./10-regular-expressions.html#whole-words-case-sensitive-by-default" id="whole-words-case-sensitive-by-default"><h2>Whole words, case sensitive by default</h2></a>
<p>However, <code>grep</code> can employ stricter and
more powerful syntax than a Google search.
Since the contents of <strong>cities.csv</strong> are all in lowercase,
if I run the above command without the city named capitalized,
then <code>grep</code> will return nothing:</p>
<pre><code>grep &quot;san antonio&quot; cities.csv
</code></pre>
<p>In order to tell grep to ignore case,
I need to use the <code>-i</code> option.
This is a reminder for you to run <code>man grep</code> and
to read through the documentation and
see what the various options exit for this command.</p>
<pre><code>grep -i &quot;san antonio&quot; cities.csv
</code></pre>
<a class="header" href="./10-regular-expressions.html#bracket-expressions-and-character-classes" id="bracket-expressions-and-character-classes"><h2>Bracket Expressions and Character Classes</h2></a>
<p>In conjunction with the <code>grep</code> command,
we can also use regular expressions to search the content of text files.
For example, we can use what are called <strong>bracket expressions</strong> and
<strong>character classes</strong> to search for patterns in the text.
Here again using <code>man grep</code> is very important because
it includes instructions on how to use these regular expressions.</p>
<a class="header" href="./10-regular-expressions.html#bracket-expressions" id="bracket-expressions"><h3>Bracket expressions</h3></a>
<p>From <code>man grep</code> on <strong>bracket expressions</strong>:</p>
<blockquote>
<p>A  bracket  expression  is  a  list  of  characters  enclosed  by  [ and ].
It matches any single character in that list.  If the first character of the
list is the caret ^ then it matches any character not in the list ... For
example, the regular expression [0123456789] matches any single digit.</p>
</blockquote>
<blockquote>
<p>Within a bracket expression, a range expression consists of two characters
separated by a hyphen. It matches any single character that sorts between the
two characters</p>
</blockquote>
<p>To see how this works, let's search the <strong>cities.csv</strong> file
for letters matching <strong>x, y, z</strong>.
Specifically, the following command,
because we are using a hyphen,
matches any characters <strong>in</strong> the range x,y,z:</p>
<pre><code>grep -i [x-z] cities.csv 
</code></pre>
<p>Since the carat key acts as a Boolean NOT
when placed <strong>within the brackets</strong>,
the following command matches any
characters <strong>not in</strong> the range x,y,z:</p>
<pre><code>grep -i [^x-z] cities.csv
</code></pre>
<p>Our ranges may be alphabetical or numerical.
The following command matches any numbers <strong>in</strong> the range 1,2,3:</p>
<pre><code>grep [1-3] cities.csv
</code></pre>
<p>Likewise, the following matches any numbers <strong>not in</strong> the range 1,2,3:</p>
<pre><code>grep [^1-3] cities.csv
</code></pre>
<p>We saw previously that the carat <code>^</code> key indicates
the start of line.
This is true here,
if the carat key precedes the opening bracket.
For example, the following command matches
any lines that start with the upper case letters
within the range of <strong>N,M,O,P</strong>:</p>
<pre><code>grep ^[N..P] cities.csv
New York City, NY | 8804190 | 1624
Phoenix, AZ | 1624569 | 1881
Philadelphia, PA | 1576251 | 1701
</code></pre>
<p>And we can reverse that with the following command:</p>
<pre><code>grep ^[^N..P] cities.csv
City | 2020 Census | Founded
Los Angeles, CA | 3898747 | 1781
Chicago, IL | 2746388 | 1780
Houston, TX | 2304580 | 1837
San Antonio, TX | 1451853 | 1718
San Diego, CA | 1381611 | 1769
Dallas, TX | 1288457 | 1856
San Jose, CA | 983489 | 1777
</code></pre>
<a class="header" href="./10-regular-expressions.html#character-classes" id="character-classes"><h3>Character classes</h3></a>
<p>Character classes are special types of predefined
bracket expressions.
They make it easy to search for general data.
From <code>man grep</code> on <strong>character classes</strong>:</p>
<blockquote>
<p>Finally, certain named classes of characters are predefined
within bracket expressions, as follows.
Their names are self explanatory, and they are
[:alnum:], [:alpha:], [:blank:], [:cntrl:],
[:digit:], [:graph:], [:lower:], [:print:],
[:punct:], [:space:], [:upper:], and [:xdigit:].
For example, [[:alnum:]] means the character class
of numbers and letters ...</p>
</blockquote>
<p>Here I search for anything that matches the Year column.
Specifically, I search for a blank (empty space) <code>[[:blank:]]</code>,
a four digit string <code>[[:digit:]]{4}</code>,
(the <code>{4}</code> means &quot;The preceding item is
matched exactly 4 times&quot; <code>man grep</code>,
and the number 4 can be replaced with any relevant number).
and an end of line <code>$</code>:</p>
<pre><code>grep -Eo &quot;[[:blank:]][[:digit:]]{4}$&quot; cities.csv 
 1624
 1781
 1780
 1837
 1881
 1701
 1718
 1769
 1856
 1777
</code></pre>
<p>In the above command, the <code>[[:blank:]]</code> can be excluded and
we'd still retrieve the desired results, but
I include it here for demonstration purposes.</p>
<a class="header" href="./10-regular-expressions.html#anchoring" id="anchoring"><h2>Anchoring</h2></a>
<p>As seen above, outside of bracket expansions and character classes,
we use the caret <code>^</code> to mark the beginning of a line.
We can also use the <code>$</code> to match the end of a line.
This is called <strong>anchoring</strong>.
Anchoring works in many places.
For example, search all lines that start with capital <strong>D through L</strong></p>
<pre><code>grep &quot;^[D-L]&quot; cities.csv
Los Angeles, CA | 3898747 | 1781
Houston, TX | 2304580 | 1837
Dallas, TX | 1288457 | 1856
</code></pre>
<p>And all lines that end with the numbers <strong>4, 5, or 6</strong>:</p>
<pre><code>grep &quot;[4-6]$&quot; cities.csv
New York City, NY | 8804190 | 1624
Dallas, TX | 1288457 | 1856
</code></pre>
<pre><code>grep &quot;^[D-L].*[4-6]$&quot; cities.csv
</code></pre>
<a class="header" href="./10-regular-expressions.html#repetition" id="repetition"><h2>Repetition</h2></a>
<p>If we want to use regular expressions to identify repetitive patterns,
then we can use repetition operators.
As we saw above,
the most useful one is the <code>*</code> asterisk.
But there are other options:</p>
<p>In come cases, we need to add the -E option
to extend <code>grep</code>'s regular expression functionality:</p>
<p>Here, the preceding item <strong>S</strong> is matched one or more times:</p>
<pre><code>grep -E &quot;S+&quot; cities.csv
San Antonio, TX | 1451853 | 1718
San Diego, CA | 1381611 | 1769
San Jose, CA | 983489 | 1777
</code></pre>
<p>In this search, the preceding item <strong>l</strong> is
matched exactly 2 times:</p>
<pre><code>grep -E &quot;l{2}&quot; cities.csv
Dallas, TX | 1288457 | 1856
</code></pre>
<p>Finally, in this example, the preceding item <strong>7</strong> is matched
at least two times or at most three times:</p>
<pre><code>grep -E &quot;7{2,3}&quot; cities.csv
San Jose, CA | 983489 | 1777
</code></pre>
<a class="header" href="./10-regular-expressions.html#or-searches" id="or-searches"><h2>OR searches</h2></a>
<p>We can use the vertical bar <code>|</code> to do a Boolean OR search.
In a Boolean OR statement, the statement is True if either
one part is true, the other part is true, or both are true.
In a search statement, this means that at least one part
of the search is true.</p>
<p>The following will return lines for each city because they
both appear in the file:</p>
<pre><code>grep -E &quot;San Antonio|Dallas&quot; cities.csv
San Antonio, TX | 1451853 | 1718
Dallas, TX | 1288457 | 1856
</code></pre>
<p>The following will return the San Antonio line even though
Lexington does not appear in the file:</p>
<pre><code>grep -E &quot;San Antonio|Lexington&quot; cities.csv
</code></pre>
<a class="header" href="./10-regular-expressions.html#conclusion" id="conclusion"><h2>Conclusion</h2></a>
<p>We covered a lot in this section on <code>grep</code> and regular expressions.</p>
<p>We specifically covered:</p>
<ul>
<li>multiword strings</li>
<li>whole word searches and case sensitivity</li>
<li>bracket expressions and character classes</li>
<li>anchoring</li>
<li>repetition</li>
<li>Boolean OR searches</li>
</ul>
<p>Even though we focused on <code>grep</code>,
many these regular expressions work across many programming languages.</p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a rel="prev" href="./09-bash-scripting.html" class="mobile-nav-chapters previous" title="Previous chapter">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="./p2-managing-services-software.html" class="mobile-nav-chapters next" title="Next chapter">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="./09-bash-scripting.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="./p2-managing-services-software.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
