<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Backups and DNF - Linux Systems Administration</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="linux-sysadmin.html"><strong aria-hidden="true">1.</strong> Linux Systems Administration</a></li><li class="chapter-item expanded "><a href="p1-system-basics.html"><strong aria-hidden="true">2.</strong> System Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01-history-linux-unix.html"><strong aria-hidden="true">2.1.</strong> History of Unix and Linux</a></li><li class="chapter-item expanded "><a href="02-quick-ssh-connect.html"><strong aria-hidden="true">2.2.</strong> Connect to a Remote Server</a></li><li class="chapter-item expanded "><a href="03-filesystem-file-management.html"><strong aria-hidden="true">2.3.</strong> Linux Filesystems and File Management</a></li><li class="chapter-item expanded "><a href="04-file-attributes.html"><strong aria-hidden="true">2.4.</strong> File Attributes</a></li><li class="chapter-item expanded "><a href="05-text-processing-part-1.html"><strong aria-hidden="true">2.5.</strong> Text Processing, Part 1</a></li><li class="chapter-item expanded "><a href="06-text-processing-part-2.html"><strong aria-hidden="true">2.6.</strong> Text Processing, Part 2</a></li><li class="chapter-item expanded "><a href="07-text-editors.html"><strong aria-hidden="true">2.7.</strong> Text Editors</a></li><li class="chapter-item expanded "><a href="08-revisiting-paths.html"><strong aria-hidden="true">2.8.</strong> Revisiting Paths</a></li><li class="chapter-item expanded "><a href="09-bash-scripting.html"><strong aria-hidden="true">2.9.</strong> Bash Scripting</a></li><li class="chapter-item expanded "><a href="10-regular-expressions.html"><strong aria-hidden="true">2.10.</strong> Regular Expressions</a></li></ol></li><li class="chapter-item expanded "><a href="p2-managing-services-software.html"><strong aria-hidden="true">3.</strong> Managing Services and Software</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="11-installing-linux.html"><strong aria-hidden="true">3.1.</strong> Installing Linux in VirtualBox</a></li><li class="chapter-item expanded "><a href="12-logical-volumes.html"><strong aria-hidden="true">3.2.</strong> Logical Volume Management</a></li><li class="chapter-item expanded "><a href="13-virtualbox-nat.html"><strong aria-hidden="true">3.3.</strong> Using NAT in VirtualBox</a></li><li class="chapter-item expanded "><a href="14-webconsole-nat.html"><strong aria-hidden="true">3.4.</strong> NAT Table in VirtualBox</a></li><li class="chapter-item expanded "><a href="15-managing-users-groups.html"><strong aria-hidden="true">3.5.</strong> Managing Users and Groups</a></li><li class="chapter-item expanded "><a href="16-systemd.html"><strong aria-hidden="true">3.6.</strong> systemd</a></li><li class="chapter-item expanded "><a href="17-backup-and-using-dnf.html" class="active"><strong aria-hidden="true">3.7.</strong> Backups and DNF</a></li></ol></li><li class="chapter-item expanded "><a href="p3-networking-security.html"><strong aria-hidden="true">4.</strong> Networking and Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="18-tcip-networking.html"><strong aria-hidden="true">4.1.</strong> TCIP Networking</a></li><li class="chapter-item expanded "><a href="19-networking-dns-domains.html"><strong aria-hidden="true">4.2.</strong> DNS and Domain Names</a></li><li class="chapter-item expanded "><a href="20-security-chroot.html"><strong aria-hidden="true">4.3.</strong> Security and chroot</a></li><li class="chapter-item expanded "><a href="21-security-firewall.html"><strong aria-hidden="true">4.4.</strong> Security and Firewalls</a></li></ol></li><li class="chapter-item expanded "><a href="p4-lamp.html"><strong aria-hidden="true">5.</strong> Creating a LAMP Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="22-httpd-apache.html"><strong aria-hidden="true">5.1.</strong> Apache2 Web Server</a></li><li class="chapter-item expanded "><a href="23-httpd-php.html"><strong aria-hidden="true">5.2.</strong> Apache2 and PHP</a></li><li class="chapter-item expanded "><a href="24-httpd-virtualhosts.html"><strong aria-hidden="true">5.3.</strong> Apache2 and Virtual Hosts</a></li><li class="chapter-item expanded "><a href="25-httpd-mysql.html"><strong aria-hidden="true">5.4.</strong> Apache2 and MySQL</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="backing-up-and-managing-software"><a class="header" href="#backing-up-and-managing-software">Backing up and Managing Software</a></h1>
<h2 id="backup-with-rsync"><a class="header" href="#backup-with-rsync">Backup with <code>rsync</code></a></h2>
<h3 id="using-our-backups-directory"><a class="header" href="#using-our-backups-directory">Using our /backups directory</a></h3>
<p>To complete this assignment, you must have successfully completed <strong>Assignment 5: Logical Volumes</strong>.</p>
<p>In <strong>Assignment 5: Logical Volumes</strong>, we created an additional volume at <strong>/backups</strong>. In a real production scenario, we'd use separate drives and remote machines to store backups in order to full prepare for and recover from data loss. But for us, this <strong>/backups</strong> partition will work just fine.</p>
<h3 id="backup-with-rsync-1"><a class="header" href="#backup-with-rsync-1">Backup with <code>rsync</code></a></h3>
<p>In the <strong>Managing Users and Groups</strong> forum, we created a new user for our system. This means that we have at least two user accounts to backup: ours and the new uers.</p>
<p>Now we'll use the <code>rsync</code> command to backup these users' home directories to the <strong>/backups</strong> volume/partition. See <code>man rsync</code> for documentation. The basic syntax is:</p>
<pre><code>rsync option source-directory destination-directory
</code></pre>
<p>Syntax matters here. Specifically, there are two ways to backup the home directories using <code>rsync</code> depending on a small detail in our commands. Consider the next two examples:</p>
<p>In this first example, the <code>rsync</code> command will back up the home directory and all subdirectories to the <code>/backups</code> directory. Thus, <code>rsync</code> behaves differently whether I include or leave out the trailing slash after the <strong>home</strong> source-directory.</p>
<p>Thus, if I run <code>rsync</code> this way:</p>
<pre><code>rsync -ahv --delete /home /backups/
</code></pre>
<p>The results will look like this:</p>
<pre><code>ls /backups
home
ls /backups/home
linus sean
</code></pre>
<p>If I include the trailing slash after the <strong>/home/</strong> directory, like so:</p>
<pre><code>rsync -ahv --delete /home/ /backups/
</code></pre>
<p>Then <code>rsync</code> will sync the contents of the <strong>/home/</strong> directory, and the results will include not <strong>/home</strong> but the specific directories contained in <strong>/home</strong>:</p>
<pre><code>ls /backups
linus sean
</code></pre>
<h3 id="delete-option"><a class="header" href="#delete-option">Delete Option</a></h3>
<p>The <code>--delete</code> option is important. Without it, <code>rsync</code> will add new files to the destination directory when it backs up the source directory. With it, <code>rsync</code> truly syncs. Thus, if a file that was previously backed up to the destination directory and later deleted in the source directory (e.g., because it was no longer needed), then it will be deleted from the destination directory when the <code>--delete</code> option is used. This is how services like Dropbox work.</p>
<p>See other options and functionality for <code>rsync</code> here: <a href="https://www.linux.com/tutorials/how-backup-files-linux-rsync-command-line/">https://www.linux.com/tutorials/how-backup-files-linux-rsync-command-line/</a>. One of the most important options is the ability to backup up to remote machines over a network, and this can be done with the the <code>rsync</code> command.</p>
<h3 id="managing-software"><a class="header" href="#managing-software">Managing Software</a></h3>
<p>Many modern Linux distros offer some kind of package management for installing, managing, and removing software. On RedHat based systems, package management is based on <code>rpm</code> (the RedHat Package Manager). On Debian based systems, package management is based on <code>dpkg</code>.</p>
<p>There are some advanced things you can do with these base package management systems (<code>rpm</code> or <code>dpkg</code>), but most of the time it will be easier to use their front ends. For RedHat systems, the current front end is called <code>dnf</code>, and for Debian systems, it's <code>apt</code> or <code>apt-get</code>. Since the Fedora distribution is part of the RedHat universe, we'll use the <code>dnf</code> command to manage software. As always, read the <code>man dnf</code> manual for more information. See also <a href="https://dnf.readthedocs.io/en/latest/command_ref.html">the online documentation on dnf</a>.</p>
<p>Let's look at a few of the basic <code>dnf</code> commands.</p>
<h3 id="dnf-info-and-search-commands"><a class="header" href="#dnf-info-and-search-commands">dnf info and search commands</a></h3>
<p>To see a history of how <code>dnf</code> has been used on the system:</p>
<pre><code>dnf history
</code></pre>
<p>We get info on the history of a specific package on our system. Since we haven't installed anything yet, there's nothing to look at yet, but the basic syntax looks like this.</p>
<pre><code>dnf history package_name
</code></pre>
<p>To search for a package, we can use the following command to search for the <code>bash</code> package:</p>
<pre><code>dnf search bash
</code></pre>
<p>If the output is more than one page, we can <strong>pipe</strong> it through <code>less</code>.</p>
<p>To get technical information on a specific package, which we might want to do before we install it:</p>
<pre><code>dnf info bash
</code></pre>
<p>We can use <code>dnf</code> to search by tag in order to get information about a package. To get a list of possible tags to search by, we can use the following command:</p>
<pre><code>dnf reqoquery --querytags
</code></pre>
<p>Then to search by tag, we uset the following format that will show us tag-related information for the <code>bash</code> package:</p>
<pre><code>dnf repoquery --queryformat &quot;%{arch}&quot; bash
dnf repoquery --queryformat &quot;%{name}&quot; bash
dnf repoquery --queryformat &quot;%{release}&quot; bash
dnf repoquery --queryformat &quot;%{reponame}&quot; bash
</code></pre>
<p>Software managed by <code>dnf</code> is organized into groups, which contain multiple software packages. We can see a list of groups with this command:</p>
<pre><code>dnf group list
</code></pre>
<p>You should see a category called <strong>Installed Gruops</strong> and listed under that is <strong>Headless Management</strong>. You might recognize that from when we installed Fedora.</p>
<p>To see what packages would be installed with a group, such as the <strong>System Tools</strong> group, we can do:</p>
<pre><code>dnf group info &quot;System Tools&quot;
</code></pre>
<p>If we want to install the default packages with a group, then:</p>
<pre><code>sudo dnf group install &quot;System Tools&quot;
</code></pre>
<h3 id="dnf-install-process-and-commands"><a class="header" href="#dnf-install-process-and-commands">dnf install process and commands</a></h3>
<p>It's pretty simple to install a software package. The hard part will involve configuring a package after it's installed, if it's a complicated piece of software. For now, let's install <code>tmux</code>, which is a terminal multiplexer that we can use to open and manage multiple terminals in a single window.</p>
<pre><code>dnf search tmux
dnf info tmux
sudo dnf install tmux
dnf history tmux
</code></pre>
<p>To use <code>tmux</code>, I like to use the <strong>ctrl-a</strong> keybinding to control it. By default it's set to use <strong>ctrl-b</strong>. Let's configure the new keybinding like so. Here we redirect the configuration to the configureation file in our home directory. Since I'm using a single redirect <strong>&gt;</strong>, this file gets created. Remember to use a double redirect <strong>&gt;&gt;</strong> if appending to the file.</p>
<pre><code>echo &quot;set-option -g prefix C-a&quot; &gt; $HOME/.tmux.conf
</code></pre>
<p>And then start <code>tmux</code> like so:</p>
<pre><code>tmux
</code></pre>
<p>When done, just type <code>exit</code>.</p>
<h4 id="updating-the-system"><a class="header" href="#updating-the-system">Updating the system</a></h4>
<p>It's easy to update the entire system:</p>
<pre><code>sudo dnf update
sudo dnf clean all
</code></pre>
<p>The <code>dnf clean all</code> command removes the downloaded files, thereby freeing up storage space, used to update the system. It does not reverse the update.</p>
<h3 id="dnf-basics"><a class="header" href="#dnf-basics">dnf basics</a></h3>
<p>Here are the basic <code>dnf</code> commands. See <code>man dnf</code> for details:</p>
<ul>
<li><code>dnf search [name]</code></li>
<li><code>dnf install [name]</code></li>
<li><code>dnf remove [name]</code></li>
<li><code>dnf repolist</code></li>
<li><code>dnf list installed</code></li>
<li><code>dnf list available</code></li>
<li><code>dnf provides /usr/bin/bash</code></li>
<li><code>dnf info [name]</code></li>
<li><code>dnf update [name]</code></li>
<li><code>dnf check-update</code></li>
<li><code>dnf update OR dnf upgrade</code></li>
<li><code>dnf autoremove</code></li>
<li><code>dnf clean all</code></li>
<li><code>dnf help clean</code></li>
<li><code>dnf help</code></li>
<li><code>dnf history</code></li>
<li><code>dnf group list 'Python Science'</code></li>
<li><code>dnf group info 'Python Science'</code></li>
<li><code>dnf group install 'Python Science'</code></li>
<li><code>dnf group install --with -optional 'Python Science'</code></li>
<li><code>dnf group upgrade 'Python Science'</code></li>
<li><code>dnf group remove 'Python Science'</code></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="16-systemd.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="p3-networking-security.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="16-systemd.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="p3-networking-security.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
