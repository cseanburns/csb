<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Apache2 and PHP - Linux Systems Administration</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Book on entry level Linux systems administration work.">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch store.js from local - TODO add CDN when 2.x.x is available on cdnjs -->
        <script src="store.js"></script>

    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = store.get('mdbook-theme');
            if (theme === null || theme === undefined) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = store.get('mdbook-sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="p1-linux-sysadmin.html"><strong>1.</strong> Linux Systems Administration</a></li><li><ul class="section"><li><a href="01-what-is-linux.html"><strong>1.1.</strong> What is Linux?</a></li><li><a href="02-what-is-sysadmin.html"><strong>1.2.</strong> What is Systems Administration?</a></li><li><a href="03-history-linux-unix.html"><strong>1.3.</strong> History of Unix and Linux</a></li></ul></li><li><a href="p2-the-command-line.html"><strong>2.</strong> Learning the Command Line</a></li><li><ul class="section"><li><a href="04-quick-ssh-connect.html"><strong>2.1.</strong> Connect to a Remote Server</a></li><li><a href="05-the-linux-filesystem.html"><strong>2.2.</strong> The Linux Filesystem</a></li><li><a href="06-files-and-directories.html"><strong>2.3.</strong> Files and Directories</a></li><li><a href="07-file-attributes.html"><strong>2.4.</strong> File Attributes</a></li><li><a href="08-text-processing-part-1.html"><strong>2.5.</strong> Text Processing, Part 1</a></li><li><a href="09-text-processing-part-2.html"><strong>2.6.</strong> Text Processing, Part 2</a></li><li><a href="10-text-editors.html"><strong>2.7.</strong> Text Editors</a></li><li><a href="11-revisiting-paths.html"><strong>2.8.</strong> Revisiting Paths</a></li><li><a href="12-bash-scripting.html"><strong>2.9.</strong> Bash Scripting</a></li><li><a href="13-regular-expressions.html"><strong>2.10.</strong> Regular Expressions</a></li></ul></li><li><a href="p3-using-gcloud.html"><strong>3.</strong> Using Google Cloud (gcloud)</a></li><li><ul class="section"><li><a href="14-using-gcloud.html"><strong>3.1.</strong> Using gcloud for Virtual Machines</a></li><li><a href="15-expanding-storage.html"><strong>3.2.</strong> Expanding Storage</a></li></ul></li><li><a href="p4-managing-the-system.html"><strong>4.</strong> Managing the System</a></li><li><ul class="section"><li><a href="16-managing-users-groups.html"><strong>4.1.</strong> Managing Users and Groups</a></li><li><a href="17-managing-software.html"><strong>4.2.</strong> Managing Software</a></li><li><a href="18-systemd.html"><strong>4.3.</strong> systemd</a></li></ul></li><li><a href="p5-networking-security.html"><strong>5.</strong> Networking and Security</a></li><li><ul class="section"><li><a href="19-tcip-networking.html"><strong>5.1.</strong> TCIP Networking</a></li><li><a href="20-networking-dns-domains.html"><strong>5.2.</strong> DNS and Domain Names</a></li><li><a href="21-security-chroot.html"><strong>5.3.</strong> Security and chroot</a></li><li><a href="22-security-firewall.html"><strong>5.4.</strong> Security and Firewalls</a></li><li><a href="23-backups.html"><strong>5.5.</strong> Backups</a></li></ul></li><li><a href="p6-lamp.html"><strong>6.</strong> Creating a LAMP Server</a></li><li><ul class="section"><li><a href="24-httpd-apache.html"><strong>6.1.</strong> Apache2 Web Server</a></li><li><a href="25-httpd-php.html" class="active"><strong>6.2.</strong> Apache2 and PHP</a></li><li><a href="26-httpd-virtualhosts.html"><strong>6.3.</strong> Apache2 and Virtual Hosts</a></li><li><a href="27-httpd-mariadb.html"><strong>6.4.</strong> Apache2 and MariaDB</a></li></ul></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page" tabindex="-1">
                
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars" title="Toggle sidebar"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush" title="Change theme"></i>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html">
                            <i id="print-button" class="fa fa-print" title="Print this book"></i>
                        </a>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="25-httpd-php.html#installing-and-setting-php-for-apache" id="installing-and-setting-php-for-apache"><h1>Installing and Setting PHP for Apache</h1></a>
<p>PHP is a server-side programming language. Client-side programming
languages, like JavaScript, are handled by the browser, but the PHP
software must be installed on the server and made to work with the Apache
<code>httpd</code> server.</p>
<p>In order for Apache and PHP to work together, we therefore need to
install PHP. Then we'll make some modifications to Apache so that it
defaults to PHP files rather than to HTML files.</p>
<p>To get started, let's work with last week's HTTP machine that we used to
set up Apache and user directories <code>userdir</code>. You can use that machine
or you can clone it to be sure that you have a good backup in case you
need to start over.</p>
<p>Let's find the relevant packages to install. Again, make sure your system
is up to date first.</p>
<pre><code>sudo su
dnf -y upgrade
dnf search php | less
dnf info php
dnf info php-common
dnf install php php-common
</code></pre>
<p>Since we are altering how the Apache <code>httpd</code> service functions, we
need to restart the service. To check and restart services:</p>
<pre><code>systemctl status httpd.service
systemctl restart httpd.service
systemctl status httpd.service
</code></pre>
<p>If all is well, our next task is to see if the Apache <code>httpd</code> service
recognizes PHP. We will proceed to the base HTTP directory, and use
<code>nano</code> to create and open a file called <code>info.php</code>.</p>
<pre><code>cd /var/www/html/
nano info.php
</code></pre>
<p>To make sure that the Apache web server can recognize that PHP is
installed and usable, we can add test code to the <code>info.php</code> file. The
test code will give us information about the version of PHP that we
just installed:</p>
<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>
<p>Next, update file ownership for all files in this directory. They should
be owned be the Apache user:</p>
<pre><code>ls -l
chown apache:apache *
ls -l
w3m http://localhost/info.php
</code></pre>
<p>By default, if both an <strong>index.html</strong> file and an <strong>index.php</strong>
file exist in the same directory, the Apache web server will
display the <strong>index.html</strong> file if a user visits the directory (e.g.,
<code>http://example.com/</code> or <code>http://localhost/</code>). So we need to configure
Apache to display <em>index.php</em> files before displaying <em>index.html</em>
files in case both files exist in the same directory:</p>
<pre><code>cd /etc/httpd/conf/
nano httpd.conf
</code></pre>
<p>Change this line:</p>
<pre><code>DirectoryIndex index.html
</code></pre>
<p>To (that is, add <strong>index.php</strong> file to the line and make sure that it comes
before <strong>index.html</strong>. It should look like:</p>
<pre><code>DirectoryIndex index.php index.html
</code></pre>
<p>Since we have modified an Apache configuration file, we should check
that we haven't made a syntax mistake:</p>
<pre><code>apachectl configtest
</code></pre>
<p>If we get an <strong>Syntax Ok</strong> message (you can ignore the FQDN error
message), you can tell Apache to reload its config files:</p>
<pre><code>systemctl reload httpd.service
systemctl restart httpd.service
</code></pre>
<p>Now create a basic PHP page. <code>cd</code> back to the base HTTP directory and
use <code>nano</code> to create and open and <code>index.php</code> file:</p>
<pre><code>cd /var/www/html/
nano index.php
</code></pre>
<p>Add some HTML and PHP that will detect our browser to the <strong>index.php</strong>
(<a href="https://stackoverflow.com/questions/8754080/how-to-get-exact-browser-name-and-version">Source code link</a>):</p>
<pre><code>&lt;p&gt;You are using the following browser to view this site:&lt;/p&gt;

&lt;?php
echo $_SERVER['HTTP_USER_AGENT'] . &quot;\n\n&quot;;

$browser = get_browser(null, true);
print_r($browser);
?&gt;
</code></pre>
<p>Next, save and exit <code>nano</code>, change ownership of the file to Apache,
and view with <code>w3m</code>:</p>
<pre><code>chown apache:apache index.php
w3m http://localhost/
</code></pre>
<p>Of course, since we set up our hostname last week, we can use our hostname
in our URL:</p>
<pre><code>w3m http://enterprise/
</code></pre>
<p><strong>Your goal:</strong></p>
<ul>
<li>Create an <strong>index.php</strong> file in your <strong>userdir</strong></li>
<li>Add some PHP and submit screenshots, like last week, showing both
the code and the output.</li>
</ul>
<p>Test some sample PHP code from here: <a href="https://www.w3schools.com/php/php_syntax.asp">https://www.w3schools.com/php/php_syntax.asp</a></p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a rel="prev" href="24-httpd-apache.html" class="mobile-nav-chapters previous" title="Previous chapter">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="26-httpd-virtualhosts.html" class="mobile-nav-chapters next" title="Next chapter">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="24-httpd-apache.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="26-httpd-virtualhosts.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
