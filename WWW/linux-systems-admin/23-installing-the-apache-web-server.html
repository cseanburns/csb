<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Installing the Apache Web Server - Linux Systems Administration</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Entry level book on Linux systems administration.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="p1-linux-sysadmin.html"><strong aria-hidden="true">1.</strong> Linux Systems Administration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01-history-linux-unix.html"><strong aria-hidden="true">1.1.</strong> History of Unix and Linux</a></li><li class="chapter-item expanded "><a href="02-what-is-linux.html"><strong aria-hidden="true">1.2.</strong> What is Linux?</a></li><li class="chapter-item expanded "><a href="03-what-is-sysadmin.html"><strong aria-hidden="true">1.3.</strong> What is Systems Administration?</a></li></ol></li><li class="chapter-item expanded "><a href="p2-using-gcloud.html"><strong aria-hidden="true">2.</strong> Using Google Cloud (gcloud)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="05-using-gcloud-virtual-machines.html"><strong aria-hidden="true">2.1.</strong> Using gcloud for Virtual Machines</a></li></ol></li><li class="chapter-item expanded "><a href="p3-the-command-line.html"><strong aria-hidden="true">3.</strong> Learning the Command Line</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="06-the-linux-filesystem.html"><strong aria-hidden="true">3.1.</strong> The Linux Filesystem</a></li><li class="chapter-item expanded "><a href="07-files-and-directories.html"><strong aria-hidden="true">3.2.</strong> Files and Directories</a></li><li class="chapter-item expanded "><a href="08-file-attributes.html"><strong aria-hidden="true">3.3.</strong> File Attributes</a></li><li class="chapter-item expanded "><a href="09-text-processing-part-1.html"><strong aria-hidden="true">3.4.</strong> Text Processing: Part 1</a></li><li class="chapter-item expanded "><a href="10-text-processing-part-2.html"><strong aria-hidden="true">3.5.</strong> Text Processing: Part 2</a></li><li class="chapter-item expanded "><a href="11-text-editors.html"><strong aria-hidden="true">3.6.</strong> Text Editors</a></li><li class="chapter-item expanded "><a href="12-revisiting-directory-paths.html"><strong aria-hidden="true">3.7.</strong> Revisiting Directory Paths</a></li><li class="chapter-item expanded "><a href="13-bash-scripting.html"><strong aria-hidden="true">3.8.</strong> Bash Scripting</a></li><li class="chapter-item expanded "><a href="14-regular-expressions.html"><strong aria-hidden="true">3.9.</strong> Regular Expressions</a></li></ol></li><li class="chapter-item expanded "><a href="p4-managing-the-system.html"><strong aria-hidden="true">4.</strong> Managing the System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="15-expanding-storage.html"><strong aria-hidden="true">4.1.</strong> Expanding Storage</a></li><li class="chapter-item expanded "><a href="16-managing-users-groups.html"><strong aria-hidden="true">4.2.</strong> Managing Users and Groups</a></li><li class="chapter-item expanded "><a href="17-managing-software.html"><strong aria-hidden="true">4.3.</strong> Managing Software</a></li><li class="chapter-item expanded "><a href="18-using-systemd.html"><strong aria-hidden="true">4.4.</strong> Using systemd</a></li></ol></li><li class="chapter-item expanded "><a href="p5-networking-security.html"><strong aria-hidden="true">5.</strong> Networking and Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="19-networking-tcpip.html"><strong aria-hidden="true">5.1.</strong> Networking and TCP/IP</a></li><li class="chapter-item expanded "><a href="20-dns-domain-names.html"><strong aria-hidden="true">5.2.</strong> DNS and Domain Names</a></li><li class="chapter-item expanded "><a href="21-local-security.html"><strong aria-hidden="true">5.3.</strong> Local Security</a></li><li class="chapter-item expanded "><a href="22-firewall-backups.html"><strong aria-hidden="true">5.4.</strong> Firewalls and Backups</a></li></ol></li><li class="chapter-item expanded "><a href="p6-creating-a-lamp-server.html"><strong aria-hidden="true">6.</strong> Creating a LAMP Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="23-installing-the-apache-web-server.html" class="active"><strong aria-hidden="true">6.1.</strong> Installing the Apache Web Server</a></li><li class="chapter-item expanded "><a href="24-installing-configuring-php.html"><strong aria-hidden="true">6.2.</strong> Installing and Configuring PHP</a></li><li class="chapter-item expanded "><a href="25-installing-configuring-mariadb.html"><strong aria-hidden="true">6.3.</strong> Installing and Configuring MariaDB</a></li></ol></li><li class="chapter-item expanded "><a href="p7-conclusion.html"><strong aria-hidden="true">7.</strong> Conclusion</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cseanburns/linux_sysadmin" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="installing-the-apache-web-server"><a class="header" href="#installing-the-apache-web-server">Installing the Apache Web Server</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p><a href="https://httpd.apache.org/">Apache</a> is an HTTP server,
otherwise called web server software.
Other HTTP server software exists.
Another big one is <a href="https://nginx.org/en/">nginx</a>.
An HTTP server essentially makes files on a computer available
to others who are able to establish a
connection to the computer and view the files
with a web browser.</p>
<p>It's important to understand the basics of an HTTP server, and
therefore I ask you to read Apache's
<a href="https://httpd.apache.org/docs/2.4/getting-started.html">Getting Started</a> page before
proceeding with the rest of this section.
Each of the main sections on that page describe
the important elements that make up and serve a website,
including</p>
<ul>
<li>clients, servers, and URLs</li>
<li>hostnames and DNS</li>
<li>configuration files and directives</li>
<li>web site content</li>
<li>log files and troubleshooting</li>
</ul>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Before we install Apache,
we need to update our systems first.</p>
<pre><code>sudo apt update
sudo apt -y upgrade
</code></pre>
<p>Once the machine is updated,
we can install Apache2 using <code>apt</code>.
First we'll use <code>apt search</code> to identify
the specific package name.
I already know that a lot of results
will be returned,
so let's <strong>pipe</strong> the <code>apt search</code> command
through <code>head</code> to look at the initial results:</p>
<pre><code>sudo apt search apache2 | head
</code></pre>
<p>The package that we're interested in
happens to be named <strong>apache2</strong> on Ubuntu.
This is not a given.
On other distributions,
like Fedora,
the Apache package is called <strong>httpd</strong>.
To learn more about the <strong>apache2</strong> package,
let's examine it with the <code>apt show</code> command:</p>
<pre><code>apt show apache2
</code></pre>
<p>Once we've confirmed that <strong>apache2</strong> is the package
that we want,
we install it with the <code>apt install</code> command.
Press <strong>Y</strong> to agree to continue after running
the command below:</p>
<pre><code>sudo apt install apache2
</code></pre>
<h2 id="basic-checks"><a class="header" href="#basic-checks">Basic checks</a></h2>
<p>One of the things that makes Apache2, and
some other web servers,
powerful is the library of modules that
extend Apache's functionality.
We'll come back to modules soon.
For now,
we're going to make sure the server is up and running,
configure some basic things, and
then create a basic web site.</p>
<p>To start,
let's use <code>systemctl</code> to acquire some info about <strong>apache2</strong> and
make sure it is <em>enabled</em> and <em>running</em>:</p>
<pre><code>systemctl list-unit-files apache2.service
systemctl status apache2
</code></pre>
<p>The output shows that <strong>apache2</strong> is enabled,
which means that it will start running automatically
if the computer gets rebooted.</p>
<p>The output of the second command also shows
that <strong>apache2</strong> is enabled and
that it is also active (running).</p>
<h2 id="creating-a-web-page"><a class="header" href="#creating-a-web-page">Creating a web page</a></h2>
<p>Since <strong>apache2</strong> is up and running,
let's look at the default web page.</p>
<p>There are two ways we can look at the default web page.
We can use a command line web browser.
There are a number available, but
I like <code>w3m</code>.</p>
<p>We can also use our regular web browsers and view
the site by entering the IP address of the server
in our browser URL bar.</p>
<p>To check with <code>w3m</code>,
we have to install it first:</p>
<pre><code>sudo apt install w3m
</code></pre>
<p>Once it's installed,
we can visit our default site using the loopback IP address
(aka, <em>localhost</em>).
From the command line on our server,
we can run either of these two commands:</p>
<pre><code>w3m 127.0.0.1
w3m localhost
</code></pre>
<p>We can also get the subnet/private IP address
using the <code>ip a</code> command, and
then use that with <code>w3m</code>.
For example, if <code>ip a</code> showed that my NIC
has an IP address of <strong>10.0.1.1</strong>, then
I could use <code>w3m</code> with that IP address:</p>
<pre><code>w3m 10.0.1.1
</code></pre>
<p>If the <strong>apache2</strong> installed and started correctly,
then you should see the following text at the top
of the screen:</p>
<p><strong>Apache2 Ubuntu Default Page</strong><br />
<strong>It works!</strong></p>
<p>To exit <code>w3m</code>,
press <strong>q</strong> and then <strong>y</strong> to confirm exit.</p>
<p>To view the default web page using
a regular web browser,
like Firefox, Chrome, Safari, Edge, or etc.,
you need to get our server's public IP address.
To do that,
log into the
<a href="https://console.cloud.google.com/">Google Cloud Console</a>,
in the left hand navigation panel,
hover your cursor over the <strong>Compute Engine</strong> link, and
then click on <strong>VM instances</strong>.
You should see your <strong>External IP</strong> address
in the table on that page.
You can copy that external IP address or
simply click on it to open it in a new browser tab.
Then you should see the graphical version of the
<strong>Apache2 Ubuntu Default Page</strong>.</p>
<p>Please take a moment to read through
the text on the default page.
It provides important information about
where Ubuntu stores configuration files and
what those files do, and
document roots,
which is where website files go.</p>
<h2 id="create-a-web-page"><a class="header" href="#create-a-web-page">Create a Web Page</a></h2>
<p>Let's create our first web page.
The default page described above provides
the location of the document root at
<strong>/var/www/html</strong>.
When we navigate to that location,
we'll see that there is already an <strong>index.html</strong>
file located in that directory.
This is the <strong>Apache2 Ubuntu Default Page</strong>
that we described above.
Let's rename that <strong>index.html</strong> file,
and create a new one:</p>
<pre><code>cd /var/www/html/
sudo mv index.html index.html.original
sudo nano index.html
</code></pre>
<p>If you know HTML, then
feel free to write some basic HTML code to get started.
Otherwise, you can re-type the content below
in <code>nano</code>, and
then save and exit out.</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;My first web page using Apache2&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h1&gt;Welcome&lt;/h1&gt;

&lt;p&gt;Welcome to my web site. I created this site using the Apache2 HTTP server.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>If you have our site open in your web browser,
reload the page, and you should see
the new text.</p>
<p>You can still view the original default page by
specifying its name in the URL.
For example, if your <strong>external IP address</strong> is
<strong>55.222.55.222</strong>, then you'd specify it like so:</p>
<pre><code>http://55.222.55.222/index.html.original
</code></pre>
<h2 id="user-directories"><a class="header" href="#user-directories">User Directories</a></h2>
<p>You may have visited sites in the past
that have a tilde in the URL and look like this:</p>
<pre><code>http://example.com/~user/
</code></pre>
<p>These are called user directories, and
the provide additional path to the <strong>document root</strong>
that's located in users' home directories
in a directory called <strong>public_html</strong>.
This is the default document root for user directories,
but the default can be changed to different locations.
Please read the documentation on what's called the
<a href="https://httpd.apache.org/docs/2.4/mod/mod_userdir.html">Apache Module mod_userdir</a> before proceeding.</p>
<p>By default, users with accounts on the server
need to have a <strong>public_html</strong> directory
in their home directories, and
Apache2 needs to be configured
to serve sites from those directories.
For example, for the user <strong>linus</strong>,
they should have the following file path available:</p>
<pre><code>/home/linus/public_html/
</code></pre>
<h3 id="enable-mod_userdir"><a class="header" href="#enable-mod_userdir">Enable mod_userdir</a></h3>
<p>The configuration file for <strong>mod_userdir</strong> is
located in <strong>/etc/apache2/mods-available/</strong>
and is named <strong>userdir.conf</strong>.
Files in this directory are modules that
are available to Apache2 but that are not
enabled (i.e., they're turned off) by default.
We can view that the <strong>userdir.conf</strong> file
with the <code>less</code> command:</p>
<pre><code>less /etc/apache2/mods-available/userdir.conf
</code></pre>
<p>The default configuration does not need to be modified.
Therefore, all we need to do is enable this module.
To do that, we use the <code>a2enmod</code> Apache2 command
(see <code>man a2enmod</code> for details.)</p>
<pre><code>sudo a2enmod userdir
</code></pre>
<p>After enabling,
we need to reload the HTTP service, and
we can also check its status:</p>
<pre><code>sudo systemctl restart apache2
systemctl status apache2
</code></pre>
<h3 id="create-a-user-directory-website"><a class="header" href="#create-a-user-directory-website">Create a User Directory Website</a></h3>
<p>Let's say I am logged in as the user <strong>linus</strong> on the system and
will use that to test if the user directory is working.
First, let's go home.
For me, as the user <strong>linus</strong>,
that would <strong>/home/linus/</strong>, and
I just have to type in the <code>cd</code> command and press Enter:</p>
<pre><code>cd
</code></pre>
<p>Now I need to create a <strong>public_html</strong> directory
in my home directory
(<strong>make sure you're in your home directory!</strong>), and
change into that directory:</p>
<pre><code>mkdir public_html
cd public_html
</code></pre>
<p>By default, Apache2 looks for a file
named <strong>index.html</strong> in the document root.
I'll create that and add some basic HTML to it:</p>
<pre><code>nano index.html
</code></pre>
<p>And in that file:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;My home site&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;p&gt;This is my home site.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Now simply add <strong>/~linus/</strong> to your external IP
address in your browser's URL bar.
Like so
(of course, replace the external IP address with
your external IP address and the username with
the username that you're using):</p>
<pre><code>http://55.222.55.222/~linus/
</code></pre>
<p>Note that this process is pretty easy but
that it will be different on other distributions.
For example, the <strong>Fedora</strong> distribution has different
<strong>Apache2</strong> defaults.
Also, on some distributions,
we might need to change the directory permissions
before this will work.
By default, Ubuntu sets directory permissions to
on our home directories to:</p>
<pre><code>drwxr-xr-x
</code></pre>
<p>That means that any user can view the contents
of our home directories.
And Ubuntu sets directories created with <code>mkdir</code>
in the home directory with these permissions by default:</p>
<pre><code>drwxrwxr-x
</code></pre>
<p>These default settings make those directories
world readable, but
other distributions do not default to those permissions.
If the last <code>r-x</code> was set to <code>---</code>, then
we would need to use the <code>chmod</code> command
to make these directories executable and readable
before files in our <strong>public_html</strong> directory
could be accessed in a browser.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>In this section,
we learned about the Apache2 HTTP server.
We learned how to install it on Ubuntu,
how to use systemd (<code>systemctl</code>) commands
to check its default status,
how to create a basic web page in <strong>/var/www/html</strong>,
how to view that web page using the <code>w3m</code>
command line browser and with our regular graphical browser,
how to enable the user directory module, and
repeat the steps above to create a website
in our home directories.</p>
<p>In the next section,
we will learn how to make our sites applications
by installing PHP and enabling the relevant PHP modules.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="p6-creating-a-lamp-server.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="24-installing-configuring-php.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="p6-creating-a-lamp-server.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="24-installing-configuring-php.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
