<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Installing and Configuring PHP - Linux Systems Administration</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Book on entry level Linux systems administration work.">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch store.js from local - TODO add CDN when 2.x.x is available on cdnjs -->
        <script src="store.js"></script>

    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = store.get('mdbook-theme');
            if (theme === null || theme === undefined) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = store.get('mdbook-sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="p1-linux-sysadmin.html"><strong>1.</strong> Linux Systems Administration</a></li><li><ul class="section"><li><a href="01-history-linux-unix.html"><strong>1.1.</strong> History of Unix and Linux</a></li><li><a href="02-what-is-linux.html"><strong>1.2.</strong> What is Linux?</a></li><li><a href="03-what-is-sysadmin.html"><strong>1.3.</strong> What is Systems Administration?</a></li></ul></li><li><a href="p2-using-gcloud.html"><strong>2.</strong> Using Google Cloud (gcloud)</a></li><li><ul class="section"><li><a href="05-using-gcloud-virtual-machines.html"><strong>2.1.</strong> Using gcloud for Virtual Machines</a></li></ul></li><li><a href="p3-the-command-line.html"><strong>3.</strong> Learning the Command Line</a></li><li><ul class="section"><li><a href="06-the-linux-filesystem.html"><strong>3.1.</strong> The Linux Filesystem</a></li><li><a href="07-files-and-directories.html"><strong>3.2.</strong> Files and Directories</a></li><li><a href="08-file-attributes.html"><strong>3.3.</strong> File Attributes</a></li><li><a href="09-text-processing-part-1.html"><strong>3.4.</strong> Text Processing: Part 1</a></li><li><a href="10-text-processing-part-2.html"><strong>3.5.</strong> Text Processing: Part 2</a></li><li><a href="11-text-editors.html"><strong>3.6.</strong> Text Editors</a></li><li><a href="12-revisiting-directory-paths.html"><strong>3.7.</strong> Revisiting Directory Paths</a></li><li><a href="13-bash-scripting.html"><strong>3.8.</strong> Bash Scripting</a></li><li><a href="14-regular-expressions.html"><strong>3.9.</strong> Regular Expressions</a></li></ul></li><li><a href="p4-managing-the-system.html"><strong>4.</strong> Managing the System</a></li><li><ul class="section"><li><a href="15-expanding-storage.html"><strong>4.1.</strong> Expanding Storage</a></li><li><a href="16-managing-users-groups.html"><strong>4.2.</strong> Managing Users and Groups</a></li><li><a href="17-managing-software.html"><strong>4.3.</strong> Managing Software</a></li><li><a href="18-using-systemd.html"><strong>4.4.</strong> Using systemd</a></li></ul></li><li><a href="p5-networking-security.html"><strong>5.</strong> Networking and Security</a></li><li><ul class="section"><li><a href="19-networking-tcpip.html"><strong>5.1.</strong> Networking and TCP/IP</a></li><li><a href="20-dns-domain-names.html"><strong>5.2.</strong> DNS and Domain Names</a></li><li><a href="21-local-security.html"><strong>5.3.</strong> Local Security</a></li><li><a href="22-firewall-backups.html"><strong>5.4.</strong> Firewalls and Backups</a></li></ul></li><li><a href="p6-creating-a-lamp-server.html"><strong>6.</strong> Creating a LAMP Server</a></li><li><ul class="section"><li><a href="23-installing-the-apache-web-server.html"><strong>6.1.</strong> Installing the Apache Web Server</a></li><li><a href="24-installing-configuring-php.html" class="active"><strong>6.2.</strong> Installing and Configuring PHP</a></li><li><a href="25-installing-configuring-mariadb.html"><strong>6.3.</strong> Installing and Configuring MariaDB</a></li></ul></li><li><a href="p7-conclusion.html"><strong>7.</strong> Conclusion</a></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page" tabindex="-1">
                
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars" title="Toggle sidebar"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush" title="Change theme"></i>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html">
                            <i id="print-button" class="fa fa-print" title="Print this book"></i>
                        </a>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="24-installing-configuring-php.html#installing-and-configuring-php" id="installing-and-configuring-php"><h1>Installing and Configuring PHP</h1></a>
<a class="header" href="24-installing-configuring-php.html#introduction" id="introduction"><h2>Introduction</h2></a>
<p>Client-side programming languages, like JavaScript,
are handled by the browser.
Major browsers like Firefox, Chrome, Safari, Edge, etc.
all include <a href="https://en.wikipedia.org/wiki/JavaScript_engine">JavaScript engines</a> that use
just-in-time compilers to execute the JavaScript code
(Mozilla has a <a href="https://blog.mozilla.org/javascript/">nice description</a> of the process.)
From an end user's perspective,
you basically install JavaScript when you install a web browser.</p>
<p><a href="https://www.php.net/">PHP</a>, on the other hand,
is a server-side programming language,
which means it must be installed on the server
in order to be used.
From a system or web administrator's perspective,
this means that not only does PHP have be installed
on a server, but
it must also be configured to work with the HTTP server,
which in our case is Apache2.</p>
<p>The main use of PHP is to interact with databases,
like MySQL, MariaDB, PostgreSQL, etc.,
in order to create dynamic page content.
This is our goal in the last part of this class.
To accomplish this, we have to:</p>
<ol>
<li>Install PHP and relevant Apache2 modules</li>
<li>Configure PHP and relevant modules to work with Apache2</li>
<li>Configure PHP and relevant modules to work with MariaDB</li>
</ol>
<a class="header" href="24-installing-configuring-php.html#install-php" id="install-php"><h2>Install PHP</h2></a>
<p>As normal, we will use <code>apt install</code>
to install PHP and relevant modules and
then restart Apache2 using the <code>systemctl</code> command:</p>
<pre><code>sudo apt install php libapache2-mod-php
sudo systemctl restart apache2
</code></pre>
<p>We can check its status and
see if there are any errors:</p>
<pre><code>systemctl status apache2
</code></pre>
<a class="header" href="24-installing-configuring-php.html#check-install" id="check-install"><h2>Check Install</h2></a>
<p>To check that it's been installed and that
it's working with Apache2,
we can create a small PHP file in our
web document root.
To do that,
we change to the <strong>/var/www/html/</strong> directory, and
create a file called <strong>info.php</strong>:</p>
<pre><code>cd /var/www/html/
sudo nano info.php
</code></pre>
<p>In that file,
add the following text,
then save and close the file:</p>
<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>
<p>No visit that file using the external IP address
for your server.
For example, in Firefox, Chrome, etc, go to
(<strong>be sure to replace the IP below with your IP address</strong>):</p>
<pre><code>http://55.333.55.333/info.php
</code></pre>
<p>You should see a page that provides system information
about PHP, Apache2, and the server.
The top of the page should look like Figure 1 below:</p>
<figure>
<img src="images/24-phpinstall.png"
alt="PHP install page"
title="PHP install page">
<figcaption>
Fig. 1. A screenshot of the title of the PHP install page.
</figcaption>
</figure>
<a class="header" href="24-installing-configuring-php.html#basic-configurations" id="basic-configurations"><h2>Basic Configurations</h2></a>
<p>By default, when Apache2 serves a web page,
it looks for and servers a
<a href="https://httpd.apache.org/docs/current/mod/mod_dir.html">file titled <strong>index.html</strong></a>,
even if it does not display that file in the URL bar.
Thus, <code>http://example.com/</code> actually
resolves to <code>http://example.com/index.html</code>
in such cases.</p>
<p>However, if our plan is to provide for PHP,
we want Apache2 to default to a file titled <strong>index.php</strong> instead and
to the <strong>index.html</strong> file as backup.
To configure that,
we need to edit the <strong>dir.conf</strong> file
in the <strong>/etc/apache2/mods-enabled/</strong> directory.
In that file there is a line that starts with
<strong>DirectoryIndex</strong>.
The first file in that line is <strong>index.html</strong>, and then
there are a series of other files that Apache2 will
look for in the order listed.
If any of those files exist in the document root,
then Apache2 will serve those before proceeding to the next.
We simply want to put <strong>index.php</strong> first and let
<strong>index.html</strong> be second on that line.</p>
<pre><code>cd /etc/apache2/mods-enabled/
sudo nano dir.conf
</code></pre>
<p>And change the line to this:</p>
<pre><code>DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm
</code></pre>
<p>Whenever we make a configuration change,
we can use the <code>apachectl</code> command to
check our configuration:</p>
<pre><code>apachectl configtest
</code></pre>
<p>If we get an <strong>Syntax Ok</strong> message,
you can reload the Apache2 configuration and
restart the service:</p>
<pre><code>sudo systemctl reload apache2
sudo systemctl restart apache2
</code></pre>
<p>Now create a basic PHP page.
<code>cd</code> back to the document root directory and
use <code>nano</code> to create and open and <code>index.php</code> file:</p>
<pre><code>cd /var/www/html/
nano index.php
</code></pre>
<a class="header" href="24-installing-configuring-php.html#creating-an-indexphp-file" id="creating-an-indexphp-file"><h2>Creating an index.php File</h2></a>
<p>Let's now create an <strong>index.php</strong> page, and
add some HTML and PHP to it.
The PHP can be a simple <a href="https://stackoverflow.com/questions/8754080/how-to-get-exact-browser-name-and-version">browser detector</a>.
Change to the <strong>/var/www/html/</strong> directory,
and use <code>sudo nano</code> to create and edit <strong>index.php</strong>.
Then add the following code:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Broswer Detector&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;You are using the following browser to view this site:&lt;/p&gt;

&lt;?php
echo $_SERVER['HTTP_USER_AGENT'] . &quot;\n\n&quot;;

$browser = get_browser(null, true);
print_r($browser);
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Next, save the file and exit <code>nano</code>.
In your browser,
visit your external IP address site:</p>
<pre><code>http://55.333.55.333/
</code></pre>
<p>Although your <strong>index.html</strong> file still exists
in your document root,
Apache2 now returns the <strong>index.php</strong> file
instead.
However, if for some reason the <strong>index.php</strong>
was deleted,
then Apache2 would revert to the <strong>index.html</strong> file
since that's what's next in the <strong>dir.conf</strong>
<strong>DirectoryIndex</strong> line.</p>
<a class="header" href="24-installing-configuring-php.html#conclusion" id="conclusion"><h2>Conclusion</h2></a>
<p>In this section,
we installed PHP and configured it work with Apache2.
We also created a simple PHP test page
that reported our browser user agent information
on our website.</p>
<p>In the next section,
we'll learn how to complete the LAMP stack
by adding the MariaDB relational database
to our setup.</p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a rel="prev" href="23-installing-the-apache-web-server.html" class="mobile-nav-chapters previous" title="Previous chapter">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="25-installing-configuring-mariadb.html" class="mobile-nav-chapters next" title="Next chapter">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="23-installing-the-apache-web-server.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="25-installing-configuring-mariadb.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
